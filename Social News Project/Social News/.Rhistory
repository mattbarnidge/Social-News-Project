long.t1 <- merge(long.st, long.engage, by=c("ID", "ng"))
long.t2 <- merge(long.t1, long.agree, by=c("ID", "ng"))
long.t3 <- merge(long.t2, long.sim, by=c("ID", "ng"))
long.t4 <- merge(long.t3, long.lik, by=c("ID", "ng"))
long <- merge(long.t4, long.clo.plus, by=c("ID", "ng"))
rm(long.agree, long.clo.plus, long.engage, long.sim, long.lik, long.st,
long.t1, long.t2, long.t3, long.t4)
head(long)
with(long, (cor(cbind(st, engage.x, agree, sim, lik, clo),
use="complete.obs")))
#Load Data
setwd("~/Documents/GitHub/Social-News-Project/Social News Project/Social News")
load("socnews.Rdata")
load("long.Rdata")
#MLM
library(lme4)
library(lmerTest)
library(sjstats)
m1 = lmer(sim ~ agree + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
m2 = lmer(lik ~ agree + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
m3 = lmer(clo ~ agree + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
icc(m1)
icc(m2)
icc(m3)
summary(m1, cor=FALSE)
summary(m2, cor=FALSE)
summary(m3, cor=FALSE)
names(d)
table(d$fb.acct)
with(subset(d, fb.acct==1),
cor(cbind(d$fb.freq, d$soccon, d$combel),
use="complete.obs", method="pearson"))
names(d)
with(subset(d, fb.acct==1),
cor(cbind(d$fbnews, d$soccon, d$combel),
use="complete.obs", method="pearson"))
m4 = lmer(engage.x ~ agree + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
names(long)
m4 = lmer(engage.x ~ agree*int + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
m4 = lmer(engage.x ~ agree*I(abs(pid)) + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
m4 = lmer(engage.x ~ agree*I(abs(ideo)) + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
m4 = lmer(engage.x ~ agree + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
m4 = lmer(soccon ~ agree*engage.x + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
m4 = lmer(soccon ~ engage.x + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
m4 = lmer(soccon ~ agree + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
m4 = lmer(combel ~ agree + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
m4 = lmer(combel ~ engage.x + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
m4 = lmer(soccon ~ engage.x + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
m4 = lmer(soccon ~ engage.x + (1 + engage.x | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
m4 = lmer(combel ~ engage.x + (1 + engage.x | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
mean(long$agree)
mean(long$agree, na.rm=TRUE)
summary(long$agree)
m4 = lmer(soccon ~ agree + engage.x + (1 + agree + engage.x | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
m4 = lmer(soccon ~ agree + engage.x + (1 | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
summary(long$engage.x)
hist(long$engage.x)
hist(long$agree)
summary(m4)
names(long)
m4 = lmer(soctrust ~ agree + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
names(xd)
names(d)
names(long)
m4 = lmer(commtrust ~ agree + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
with(subset(d, fb.acct==1),
cor(cbind(d$fb.freq, d$soccon, d$combel,
d$soctrust, d$commtrust, d$newstrust, d$newstrust2,
d$bustrust, d$govtrust, d$scitrust),
use="complete.obs", method="pearson"))
length(subset(d, fb.acct == 1 & names > 0))
#Load Data and Libraries
setwd("~/Documents/GitHub/Social-News-Project/Social News Project/Social News")
load("socnews.Rdata")
load("long.Rdata")
length(subset(d, fb.acct == 1 & names > 0))
1212/3
length(subset(d, names > 0))
#Create tie strength variable
d$ng1.st <- NA
d$ng1.st = ifelse(d$ng1.fam == 1 | d$ng1.fri == 1, 1, d$ng1.st)
d$ng1.st = ifelse(d$ng1.cow == 1 | d$ng1.acq == 1 | d$ng1.nei == 1, 0, d$ng1.st)
d$ng2.st <- NA
d$ng2.st = ifelse(d$ng2.fam == 1 | d$ng2.fri == 1, 1, d$ng2.st)
d$ng2.st = ifelse(d$ng2.cow == 1 | d$ng2.acq == 1 | d$ng2.nei == 1, 0, d$ng2.st)
d$ng3.st <- NA
d$ng3.st = ifelse(d$ng3.fam == 1 | d$ng3.fri == 1, 1, d$ng3.st)
d$ng3.st = ifelse(d$ng3.cow == 1 | d$ng3.acq == 1 | d$ng3.nei == 1, 0, d$ng3.st)
#Create ID var
d$ID = row.names(d)
#Filter
d$ng1.st[d$name1 == 0] <- NA
d$ng2.st[d$name2 == 0] <- NA
d$ng3.st[d$name3 == 0] <- NA
d$ng1.engage[d$name1 == 0] <- NA
d$ng2.engage[d$name2 == 0] <- NA
d$ng3.engage[d$name3 == 0] <- NA
d$ng1.agree[d$name1 == 0] <- NA
d$ng2.agree[d$name2 == 0] <- NA
d$ng3.agree[d$name3 == 0] <- NA
d$ng1.sim[d$name1 == 0] <- NA
d$ng2.sim[d$name2 == 0] <- NA
d$ng3.sim[d$name3 == 0] <- NA
d$ng1.lik[d$name1 == 0] <- NA
d$ng2.lik[d$name2 == 0] <- NA
d$ng3.lik[d$name3 == 0] <- NA
d$ng1.clo[d$name1 == 0] <- NA
d$ng2.clo[d$name2 == 0] <- NA
d$ng3.clo[d$name3 == 0] <- NA
#Filter again
x <- subset(d, names > 0)
save(x, file="sub.Rdata")
rm(long, x, d)
#Load Data and Libraries
setwd("~/Documents/GitHub/Social-News-Project/Social News Project/Social News")
load("socnews.Rdata")
load("sub.Rdata")
load("long.Rdata")
m1 = lm(soccon ~ fb.freq + age + gender + poc + edu + inc,
data=x)
m2 = lm(combel ~ fb.freq + age + gender + poc + edu + inc,
data=x)
m3 = lm(soctrust ~ fb.freq + age + gender + poc + edu + inc,
data=x)
summary(m1)
summary(m2)
summary(m3)
summary(m2)
summary(m1)
names(x)
m4 = lm(ng.sim ~ fb.freq + age + gender + poc + edu + inc,
data=x)
m5 = lm(ng.lik ~ fb.freq + age + gender + poc + edu + inc,
data=x)
m6 = lm(ng.clo ~ fb.freq + age + gender + poc + edu + inc,
data=x)
summary(m4)
summary(m5)
summary(m6)
summary(m5)
m1 = lm(soccon ~ fb.freq + age + gender + poc + edu + inc + netsize + netdiv2, data=x)
m2 = lm(combel ~ fb.freq + age + gender + poc + edu + inc + netsize + netdiv2, data=x)
m3 = lm(soctrust ~ fb.freq + age + gender + poc + edu + inc + netsize + netdiv2, data=x)
m4 = lm(ng.sim ~ fb.freq + age + gender + poc + edu + inc + netsize + netdiv2, data=x)
m5 = lm(ng.lik ~ fb.freq + age + gender + poc + edu + inc + netsize + netdiv2, data=x)
m6 = lm(ng.clo ~ fb.freq + age + gender + poc + edu + inc + netsize + netdiv2, data=x)
summary(m1)
m2 = lm(combel ~ fb.freq + age + gender + poc + edu + inc + netsize + netdiv2, data=x)
summary(m2)
m3 = lm(soctrust ~ fb.freq + age + gender + poc + edu + inc + netsize + netdiv2, data=x)
summary(m3)
summary(m4)
summary(m5)
summary(m6)
names(long)
m1 = lmer(soccon ~ agree + engage.x + (1 | ID),
data=long, control=lmerControl(optimizer="bobyqa", optCtrl = list(maxfun=2e5)))
library(lme4)
library(lmerTest)
library(sjstats)
m1 = lmer(soccon ~ agree + engage.x + (1 | ID),
data=long, control=lmerControl(optimizer="bobyqa", optCtrl = list(maxfun=2e5)))
m1 = lmer(soccon ~ agree + (1 | ID),
data=long, control=lmerControl(optimizer="bobyqa", optCtrl = list(maxfun=2e5)))
m7 = lm(soccon ~ agree + engage.x, data=long)
summary(m7)
names(x)
m7 = lm(soccon ~ ng.agree + ng.engage, data=x)
summary(m7)
m7 = lm(soccon ~ ng.agree + ng.engage + fb.freq + age + gender + poc + edu + inc + netsize + netdiv2, data=x)
m8 = lm(combel ~ ng.agree + ng.engage + fb.freq + age + gender + poc + edu + inc + netsize + netdiv2, data=x)
m9 = lm(soctrust ~ ng.agree + ng.engage + fb.freq + age + gender + poc + edu + inc + netsize + netdiv2, data=x)
m10 = lmer(sim ~ agree + engage.x + fb.freq + age + gender + poc + edu + inc + netsize + netdiv2 + (1 + agree + engage.x | ID), data=long, control=lmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)))
m10 = lmer(sim ~ agree + engage.x + fb.freq + age + gender + poc + edu + inc + netsize + netdiv2 + (1 | ID), data=long, control=lmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)))
m11 = lmer(lik ~ agree + engage.x + fb.freq + age + gender + poc + edu + inc + netsize + netdiv2 + (1 | ID), data=long, control=lmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)))
m12 = lmer(clo ~ agree + engage.x + fb.freq + age + gender + poc + edu + inc + netsize + netdiv2 + (1 | ID), data=long, control=lmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)))
summary(m7)
summary(m8)
summary(m9)
summary(m10)
summary(m10, cor=F)
summary(m11, cor=F)
summary(m12, cor=F)
i1 = lm(soccon ~ ng.agree*ng.engage + fb.freq + age + gender + poc + edu + inc + netsize + netdiv2, data=x)
i2 = lm(combel ~ ng.agree*ng.engage + fb.freq + age + gender + poc + edu + inc + netsize + netdiv2, data=x)
i3 = lm(soctrust ~ ng.agree*ng.engage + fb.freq + age + gender + poc + edu + inc + netsize + netdiv2, data=x)
i4 = lmer(sim ~ agree*engage.x + fb.freq + age + gender + poc + edu + inc + netsize + netdiv2 + (1 | ID), data=long, control=lmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)))
i5 = lmer(lik ~ agree*engage.x + fb.freq + age + gender + poc + edu + inc + netsize + netdiv2 + (1 | ID), data=long, control=lmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)))
i6 = lmer(clo ~ agree*engage.x + fb.freq + age + gender + poc + edu + inc + netsize + netdiv2 + (1 | ID), data=long, control=lmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)))
summary(i1)
summary(i2)
summary(i3)
summary(i4)
summary(i4, cor=F)
summary(i5, cor=F)
summary(i6, cor=F)
visreg::visreg(i4, "engage.x", by="agree")
visreg::visreg(i4, "engage.x", by="agree")
visreg::visreg(i5, "engage.x", by="agree")
visreg::visreg(i6, "engage.x", by="agree")
with(x, cor(cbind(soccon, combel, soctrust, ng.sim, ng.lik, ng.clo),
use="complete.obs", method="pearson"))
library(lavaan)
r1 = lm(fb.freq ~ age + gender + poc + edu + inc + netsize + netdiv2, data=x, na.action=na.exclude)
x$x1 <- residuals(r1)
sem1 <- '
soccon ~ x1
combel ~ x1
soctrust ~ x1
soccon ~~ combel
soccon ~~ soctrust
combel ~~ soctrust
'
fit1 <- sem(sem1, data = x)
summary(fit1)
sem1 <- '
soccon ~ x1
combel ~ x1
soctrust ~ x1
'
fit1 <- sem(sem1, data = x)
summary(fit1)
sem1 <- '
soccon ~ x1
combel ~ x1
soctrust ~ x1
soccon ~~ 1*soccon
'
fit1 <- sem(sem1, data = x)
summary(fit1)
modindices(fit1)
sem1 <- '
soccon ~ x1
combel ~ x1
soctrust ~ x1
soccon ~~ 1*soccon
soccon ~~ combel
soccon ~~ soctrust
combel ~~ soctrust
'
fit1 <- sem(sem1, data = x)
summary(fit1)
with(x, cor(cbind(soccon, combel, soctrust, ng.sim, ng.lik, ng.clo),
use="complete.obs", method="pearson"))
sem1 <- '
soccon ~ x1
combel ~ x1
soctrust ~ x1
soccon ~~ .46*combel
'
fit1 <- sem(sem1, data = x)
summary(fit1)
sem1 <- '
soccon ~ x1
combel ~ x1
soctrust ~ x1
soccon ~~ .46*combel
soccon ~~ .20*soctrust
combel ~~ .52*soctrust
'
fit1 <- sem(sem1, data = x)
summary(fit1)
sem1 <- '
soccon ~ x1
combel ~ x1
soctrust ~ x1
soccon ~~ .46*combel
soccon ~~ .20*soctrust
'
fit1 <- sem(sem1, data = x)
sem1 <- '
soccon ~ x1
combel ~ x1
soctrust ~ x1
soccon ~~ .46*combel
soccon ~~ 1*soccon
'
fit1 <- sem(sem1, data = x)
summary(fit1)
sem1 <- '
soccon ~ x1
combel ~ x1
soctrust ~ x1
soccon ~~ .46*combel
'
fit1 <- sem(sem1, data = x)
summary(fit1)
fitMeasures(fit1)
fitMeasures(fit1, c("chisq", "df", "pvalue", "cfi", "tli", "gfi", "rmsea", "rmsea.pvalue", "srmr"))
sem1 <- '
soccon ~ x1
combel ~ x1
soctrust ~ x1
soccon ~~ 1*soccon
'
fit1 <- sem(sem1, data = x)
fitMeasures(fit1, c("chisq", "df", "pvalue", "cfi", "tli", "gfi", "rmsea", "rmsea.pvalue", "srmr"))
sem1 <- '
soccon ~ x1
combel ~ x1
soctrust ~ x1
soccon ~~ .20*soctrust
combel ~~ .51*soctrust
'
fit1 <- sem(sem1, data = x)
sem1 <- '
soccon ~ x1
combel ~ x1
soctrust ~ x1
soccon ~~ .20*soctrust
'
fit1 <- sem(sem1, data = x)
fitMeasures(fit1, c("chisq", "df", "pvalue", "cfi", "tli", "gfi", "rmsea", "rmsea.pvalue", "srmr"))
fitMeasures(fit1, c("chisq", "df", "pvalue", "cfi",  "gfi", "rmsea", "rmsea.pvalue", "srmr"))
standardizedSolution(fit1)
modindices(fit1)
sem1 <- '
soccon ~ x1
combel ~ x1
soctrust ~ x1
'
fit1 <- sem(sem1, data = x)
fitMeasures(fit1, c("chisq", "df", "pvalue", "cfi",  "gfi", "rmsea", "rmsea.pvalue", "srmr"))
sem1 <- '
soccon ~ 1*x1
combel ~ x1
soctrust ~ x1
'
fit1 <- sem(sem1, data = x)
fitMeasures(fit1, c("chisq", "df", "pvalue", "cfi",  "gfi", "rmsea", "rmsea.pvalue", "srmr"))
standardizedSolution(fit1)
sem1 <- '
soccon ~ .10*x1
combel ~ x1
soctrust ~ x1
'
fit1 <- sem(sem1, data = x)
fitMeasures(fit1, c("chisq", "df", "pvalue", "cfi",  "gfi", "rmsea", "rmsea.pvalue", "srmr"))
standardizedSolution(fit1)
sem2 <- '
soccon ~ x1
combel ~ .10*x1
soctrust ~ x1
'
fit2 <- sem(sem2, data = x)
fitMeasures(fit2, c("chisq", "df", "pvalue", "cfi",  "gfi", "rmsea", "rmsea.pvalue", "srmr"))
standardizedSolution(fit2)
sem3 <- '
soccon ~ x1
combel ~ x1
soctrust ~ .05*x1
'
fit3 <- sem(sem3, data = x)
fitMeasures(fit3, c("chisq", "df", "pvalue", "cfi",  "gfi", "rmsea", "rmsea.pvalue", "srmr"))
standardizedSolution(fit3)
r2 = lm(ng.agree ~ age + gender + poc + edu + inc + netsize + netdiv2, data=x, na.action=na.exclude)
r3 = lm(ng.engage ~ age + gender + poc + edu + inc + netsize + netdiv2, data=x, na.action=na.exclude)
x$x2 <- residuals(r2)
x$x3 <- residuals(r3)
sem4 <- '
soccon ~ x1 + x2 + x3
combel ~ x1 + x2 + x3
soctrust ~ x1 + x2 + x3
'
fit4 <- sem(sem4, data = x)
fitMeasures(fit4, c("chisq", "df", "pvalue", "cfi",  "gfi", "rmsea", "rmsea.pvalue", "srmr"))
standardizedSolution(fit4)
summary(m7)
summary(m8)
summary(m9)
sem4 <- '
soccon ~ .06*x1 + x2 + x3
combel ~ .07*x1 + x2 + x3
soctrust ~ .03*x1 + x2 + x3
'
fit4 <- sem(sem4, data = x)
fitMeasures(fit4, c("chisq", "df", "pvalue", "cfi",  "gfi", "rmsea", "rmsea.pvalue", "srmr"))
standardizedSolution(fit4)
with(long, cor(cbind(sim, lik, clo),
use="complete.obs", method="pearson"))
r4 = lm(fb.freq ~ age + gender + poc + edu + inc + netsize + netdiv2, data=long, na.action=na.exclude)
long$x1 <- residuals(r4)
sem5 <- '
sim ~ x1
lik ~ x1
clo ~ x1
'
fit5 <- sem(sem5, data = long, group = ID)
fit5 <- sem(sem5, data = long, group = long$ID)
fit5 <- sem(sem5, data = long, cluster = long$ID)
fit5 <- sem(sem5, data = long, cluster = ID)
sem5 <- '
#level: 1
sim ~ x1
lik ~ x1
clo ~ x1
#level 2
sim ~ ID
lik ~ ID
clo ~ ID
'
fit5 <- sem(sem5, data = long)
fitMeasures(fit5, c("chisq", "df", "pvalue", "cfi",  "gfi", "rmsea", "rmsea.pvalue", "srmr"))
standardizedSolution(fit5)
fit5 <- sem(sem5, data = long, cluster = long$ID)
fit5 <- sem(sem5, data = long, cluster = cluster)
fit5 <- sem(sem5, data = long)
fitMeasures(fit5, c("chisq", "df", "pvalue", "cfi",  "gfi", "rmsea", "rmsea.pvalue", "srmr"))
standardizedSolution(fit5)
head(lavaan$Demo.twolevel)
head(Demo.twolevel)
sem5 <- '
sim ~ x1 + ID
lik ~ x1 + ID
clo ~ x1 + ID
'
fit5 <- sem(sem5, data = long)
fitMeasures(fit5, c("chisq", "df", "pvalue", "cfi",  "gfi", "rmsea", "rmsea.pvalue", "srmr"))
standardizedSolution(fit5)
sem5 <- '
aw =~ sim + lik + clo
aw ~ x1
ab =~ sim + lik + clo
ab ~ 1
'
fit5 <- sem(sem5, data = long, cluster = long$ID)
fitMeasures(fit5, c("chisq", "df", "pvalue", "cfi",  "gfi", "rmsea", "rmsea.pvalue", "srmr"))
fit5 <- sem(sem5, data = long, cluster = long$ID)
with(long, cor(cbind(sim, lik, clo),
use="complete.obs", method="pearson"))
long$affect = rowMeans(cbind(sim,lik,clo), na.rm=T)
long$affect = with(long, rowMeans(cbind(sim,lik,clo), na.rm=T))
mlm = lmer(affect ~ agree + engage.x + fb.freq +
age + gender + poc + edu + inc + netsize + netdiv2 + (1 | ID),
data=long, control=lmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)))
icc(mlm)
library(sjstats)
icc(mlm)
summary(mlm, cor=F)
options(scipen=999)
summary(mlm, cor=F)
mlm = lmer(affect ~ agree + engage.x + fb.freq +
age + gender + poc + edu + inc + netsize + netdiv2 + (1 + agree | ID),
data=long, control=lmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)))
summary(mlm, cor=F)
mlm = lmer(affect ~ agree + engage.x + fb.freq +
age + gender + poc + edu + inc + netsize + netdiv2 + (1 + agree + engage.x | ID),
data=long, control=lmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)))
summary(mlm, cor=F)
mlm = lmer(affect ~ agree + engage.x + fb.freq +
age + gender + poc + edu + inc + netsize + netdiv2 + (1 + engage.x | ID),
data=long, control=lmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)))
summary(mlm, cor=F)
mlm = lmer(affect ~ agree*engage.x + fb.freq +
age + gender + poc + edu + inc + netsize + netdiv2 + (1 | ID),
data=long, control=lmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5)))
summary(mlm, cor=F)
