d$ng1.agree[d$name1 == 0] <- NA
d$ng2.agree[d$name2 == 0] <- NA
d$ng3.agree[d$name3 == 0] <- NA
d$ng1.sim[d$name1 == 0] <- NA
d$ng2.sim[d$name2 == 0] <- NA
d$ng3.sim[d$name3 == 0] <- NA
d$ng1.lik[d$name1 == 0] <- NA
d$ng2.lik[d$name2 == 0] <- NA
d$ng3.lik[d$name3 == 0] <- NA
d$ng1.clo[d$name1 == 0] <- NA
d$ng2.clo[d$name2 == 0] <- NA
d$ng3.clo[d$name3 == 0] <- NA
#Filter again
x <- subset(d, names > 0)
reg.vars <- x %>% select(age, gender, poc, edu, inc, fb.freq,
netsize, newssize, netdiv1, netdiv2, netdiv3,
fbnews, fbnews.dis, fbnews.agr, follow, nfbnews, engage, avoid, unfriend,
fbtalk.freq, fbtalk.size, fbtalk.dis, fbtalk.agr, express,
eff.i, eff.e, int, ideo, pid, know,
soccon, combel, soctrust, commtrust, newstrust, newstrust2,
govtrust, bustrust, scitrust)
x$ng1.st <- NA
is.na(x$ng1.st)
x$ng1.st = ifelse(x$ng1.fam == 1 | x$ng.fri == 1, 1, x$ng1.st)
x$ng1.st = ifelse(x$ng1.cow == 1 | x$ng.acq == 1 | x$ng.nei == 1, 0, x$ng1.st)
table(x$ng1.st)
126+129
x$ng1.st <- NA
x$ng1.st = ifelse(x$ng1.fam == 1 | x$ng1.fri == 1, 1, x$ng1.st)
x$ng1.st = ifelse(x$ng1.cow == 1 | x$ng1.acq == 1 | x$ng1.nei == 1, 0, x$ng1.st)
table(x$ng1.st)
91+305
x$ng2.st <- NA
x$ng2.st = ifelse(x$ng2.fam == 1 | x$ng2.fri == 1, 1, x$ng2.st)
x$ng2.st = ifelse(x$ng2.cow == 1 | x$ng2.acq == 1 | x$ng2.nei == 1, 0, x$ng2.st)
table(x$ng2.st)
x$ng3.st <- NA
x$ng3.st = ifelse(x$ng3.fam == 1 | x$ng3.fri == 1, 1, x$ng3.st)
x$ng3.st = ifelse(x$ng3.cow == 1 | x$ng3.acq == 1 | x$ng3.nei == 1, 0, x$ng3.st)
table(x$ng3.st)
x.st <- x %>% select(ID, ng1.st, ng2.st, ng3.st)
x.st <- x.st %>% rename(ng1 = ng1.st, ng2 = ng2.st, ng3 = ng3.st)
x.engage <- x %>% select(ID, ng1.engage, ng2.engage, ng3.engage)
x.engage <- x.engage %>% rename(ng1 = ng1.engage, ng2 = ng2.engage, ng3 = ng3.engage)
x.agree <- x %>% select(ID, ng1.agree, ng2.agree, ng3.agree)
x.agree <- x.agree %>% rename(ng1 = ng1.agree, ng2 = ng2.agree, ng3 = ng3.agree)
x.sim <- x %>% select(ID, ng1.sim, ng2.sim, ng3.sim)
x.sim <- x.sim %>% rename(ng1 = ng1.sim, ng2 = ng2.sim, ng3 = ng3.sim)
x.lik <- x %>% select(ID, ng1.lik, ng2.lik, ng3.lik)
x.lik <- x.lik %>% rename(ng1 = ng1.lik, ng2 = ng2.lik, ng3 = ng3.lik)
x.clo <- x %>% select(ID, ng1.clo, ng2.clo, ng3.clo)
x.clo <- x.clo %>% rename(ng1 = ng1.clo, ng2 = ng2.clo, ng3 = ng3.clo)
head(x.st)
head(reg.vars)
d.st <- cbind(x.st, reg.vars)
head(d.st)
d.engage <- cbind(x.engage, reg.vars)
d.agree <- cbind(x.agree, reg.vars)
head(d.engage)
head(d.agree)
d.sim <- cbind(x.sim, reg.vars)
d.lik <- cbind(x.lik, reg.vars)
d.clo <- cbind(x.clo, reg.vars)
long.st <- gather(d.st, ng, st, ng1:ng2, factor_key = TRUE)
head(long.st)
rm(long.st)
long.st <- gather(d.st, ng, st, ng1:ng3, factor_key = TRUE)
head(long.st)
long.engage <- gather(d.engage, ng, engage, ng1:ng3, factor_key = TRUE)
long.agree <- gather(d.agree, ng, agree, ng1:ng3, factor_key=TRUE)
long.sim <- gather(d.sim, ng, sim, ng1:ng3, factor_key=TRUE)
long.lik <- gather(d.lik, ng, lik, ng1:ng3, factor_key=TRUE)
long.clo <- gather(d.clo, ng, clo, ng1:ng3, factor_key=TRUE)
rm(x.st, x.engage, x.agree, x.sim, x.lik, x.clo, reg.vars)
long.t1 <- merge(long.st, long.engage, by=c("ID", "ng"))
head(long.t1)
rm(long.t1)
long.t1 <- merge(long.st, long.engage, by=c("ID", "ng"), all.x=TRUE)
head(long.t1)
long.t1 <- merge(long.st, long.engage, by=c("ID", "ng"), all=TRUE)
head(long.t1)
long.t1 <- merge(long.st, long.engage, by.x=c("ID", "ng"))
rm(long.t1)
long.t1 <- merge(long.st, long.engage, by=intersect(names(long.st), names(long.engage)))
head(long.t1)
head(long.t1)
head(long.st)
head(long.engage)
head(long.t1)
#Load Data
setwd("~/Documents/GitHub/Social-News-Project/Social News Project/Social News")
load("socnews.Rdata")
#Create ID var
d$ID = row.names(d)
#Filter
d$ng1.agree[d$name1 == 0] <- NA
d$ng2.agree[d$name2 == 0] <- NA
d$ng3.agree[d$name3 == 0] <- NA
d$ng1.sim[d$name1 == 0] <- NA
d$ng2.sim[d$name2 == 0] <- NA
d$ng3.sim[d$name3 == 0] <- NA
d$ng1.lik[d$name1 == 0] <- NA
d$ng2.lik[d$name2 == 0] <- NA
d$ng3.lik[d$name3 == 0] <- NA
d$ng1.clo[d$name1 == 0] <- NA
d$ng2.clo[d$name2 == 0] <- NA
d$ng3.clo[d$name3 == 0] <- NA
#Filter again
x <- subset(d, names > 0)
#Create dataframe for non RM vars
reg.vars <- x %>% select(age, gender, poc, edu, inc, fb.freq,
netsize, newssize, netdiv1, netdiv2, netdiv3,
fbnews, fbnews.dis, fbnews.agr, follow, nfbnews, engage, avoid, unfriend,
fbtalk.freq, fbtalk.size, fbtalk.dis, fbtalk.agr, express,
eff.i, eff.e, int, ideo, pid, know,
soccon, combel, soctrust, commtrust, newstrust, newstrust2,
govtrust, bustrust, scitrust)
#Create tie strength variable
x$ng1.st <- NA
x$ng1.st = ifelse(x$ng1.fam == 1 | x$ng1.fri == 1, 1, x$ng1.st)
x$ng1.st = ifelse(x$ng1.cow == 1 | x$ng1.acq == 1 | x$ng1.nei == 1, 0, x$ng1.st)
x$ng2.st <- NA
x$ng2.st = ifelse(x$ng2.fam == 1 | x$ng2.fri == 1, 1, x$ng2.st)
x$ng2.st = ifelse(x$ng2.cow == 1 | x$ng2.acq == 1 | x$ng2.nei == 1, 0, x$ng2.st)
x$ng3.st <- NA
x$ng3.st = ifelse(x$ng3.fam == 1 | x$ng3.fri == 1, 1, x$ng3.st)
x$ng3.st = ifelse(x$ng3.cow == 1 | x$ng3.acq == 1 | x$ng3.nei == 1, 0, x$ng3.st)
#Load Data
setwd("~/Documents/GitHub/Social-News-Project/Social News Project/Social News")
load("socnews.Rdata")
#Create tie strength variable
x$ng1.st <- NA
x$ng1.st = ifelse(x$ng1.fam == 1 | x$ng1.fri == 1, 1, x$ng1.st)
x$ng1.st = ifelse(x$ng1.cow == 1 | x$ng1.acq == 1 | x$ng1.nei == 1, 0, x$ng1.st)
x$ng2.st <- NA
x$ng2.st = ifelse(x$ng2.fam == 1 | x$ng2.fri == 1, 1, x$ng2.st)
x$ng2.st = ifelse(x$ng2.cow == 1 | x$ng2.acq == 1 | x$ng2.nei == 1, 0, x$ng2.st)
x$ng3.st <- NA
x$ng3.st = ifelse(x$ng3.fam == 1 | x$ng3.fri == 1, 1, x$ng3.st)
x$ng3.st = ifelse(x$ng3.cow == 1 | x$ng3.acq == 1 | x$ng3.nei == 1, 0, x$ng3.st)
#Load Data
setwd("~/Documents/GitHub/Social-News-Project/Social News Project/Social News")
load("socnews.Rdata")
#Create tie strength variable
d$ng1.st <- NA
d$ng1.st = ifelse(d$ng1.fam == 1 | d$ng1.fri == 1, 1, d$ng1.st)
d$ng1.st = ifelse(d$ng1.cow == 1 | d$ng1.acq == 1 | d$ng1.nei == 1, 0, d$ng1.st)
d$ng2.st <- NA
d$ng2.st = ifelse(d$ng2.fam == 1 | d$ng2.fri == 1, 1, d$ng2.st)
d$ng2.st = ifelse(d$ng2.cow == 1 | d$ng2.acq == 1 | d$ng2.nei == 1, 0, d$ng2.st)
d$ng3.st <- NA
d$ng3.st = ifelse(d$ng3.fam == 1 | d$ng3.fri == 1, 1, d$ng3.st)
d$ng3.st = ifelse(d$ng3.cow == 1 | d$ng3.acq == 1 | d$ng3.nei == 1, 0, d$ng3.st)
#Create ID var
d$ID = row.names(d)
d$ng1.st[d$name1 == 0] <- NA
d$ng2.st[d$name2 == 0] <- NA
d$ng3.st[d$name3 == 0] <- NA
d$ng1.engage[d$name1 == 0] <- NA
d$ng2.engage[d$name2 == 0] <- NA
d$ng3.engage[d$name3 == 0] <- NA
d$ng1.agree[d$name1 == 0] <- NA
d$ng2.agree[d$name2 == 0] <- NA
d$ng3.agree[d$name3 == 0] <- NA
d$ng1.sim[d$name1 == 0] <- NA
d$ng2.sim[d$name2 == 0] <- NA
d$ng3.sim[d$name3 == 0] <- NA
d$ng1.lik[d$name1 == 0] <- NA
d$ng2.lik[d$name2 == 0] <- NA
d$ng3.lik[d$name3 == 0] <- NA
d$ng1.clo[d$name1 == 0] <- NA
d$ng2.clo[d$name2 == 0] <- NA
d$ng3.clo[d$name3 == 0] <- NA
x <- subset(d, names > 0)
reg.vars <- x %>% select(age, gender, poc, edu, inc, fb.freq,
netsize, newssize, netdiv1, netdiv2, netdiv3,
fbnews, fbnews.dis, fbnews.agr, follow, nfbnews, engage, avoid, unfriend,
fbtalk.freq, fbtalk.size, fbtalk.dis, fbtalk.agr, express,
eff.i, eff.e, int, ideo, pid, know,
soccon, combel, soctrust, commtrust, newstrust, newstrust2,
govtrust, bustrust, scitrust)
x.st <- x %>% select(ID, ng1.st, ng2.st, ng3.st)
x.st <- x.st %>% rename(ng1 = ng1.st, ng2 = ng2.st, ng3 = ng3.st)
x.engage <- x %>% select(ID, ng1.engage, ng2.engage, ng3.engage)
x.engage <- x.engage %>% rename(ng1 = ng1.engage, ng2 = ng2.engage, ng3 = ng3.engage)
x.agree <- x %>% select(ID, ng1.agree, ng2.agree, ng3.agree)
x.agree <- x.agree %>% rename(ng1 = ng1.agree, ng2 = ng2.agree, ng3 = ng3.agree)
x.sim <- x %>% select(ID, ng1.sim, ng2.sim, ng3.sim)
x.sim <- x.sim %>% rename(ng1 = ng1.sim, ng2 = ng2.sim, ng3 = ng3.sim)
x.lik <- x %>% select(ID, ng1.lik, ng2.lik, ng3.lik)
x.lik <- x.lik %>% rename(ng1 = ng1.lik, ng2 = ng2.lik, ng3 = ng3.lik)
x.clo <- x %>% select(ID, ng1.clo, ng2.clo, ng3.clo)
x.clo <- x.clo %>% rename(ng1 = ng1.clo, ng2 = ng2.clo, ng3 = ng3.clo)
x.clo.plus <- cbind(x.clo, reg.vars)
long.st <- gather(d.st, ng, st, ng1:ng3, factor_key = TRUE)
long.engage <- gather(d.engage, ng, engage, ng1:ng3, factor_key = TRUE)
long.agree <- gather(d.agree, ng, agree, ng1:ng3, factor_key=TRUE)
long.sim <- gather(d.sim, ng, sim, ng1:ng3, factor_key=TRUE)
long.lik <- gather(d.lik, ng, lik, ng1:ng3, factor_key=TRUE)
long.clo.plus <- gather(d.clo, ng, clo, ng1:ng3, factor_key=TRUE)
long.st <- gather(x.st, ng, st, ng1:ng3, factor_key = TRUE)
long.engage <- gather(x.engage, ng, engage, ng1:ng3, factor_key = TRUE)
long.agree <- gather(x.agree, ng, agree, ng1:ng3, factor_key=TRUE)
long.sim <- gather(x.sim, ng, sim, ng1:ng3, factor_key=TRUE)
long.lik <- gather(x.lik, ng, lik, ng1:ng3, factor_key=TRUE)
long.clo.plus <- gather(x.clo.plus, ng, clo, ng1:ng3, factor_key=TRUE)
head(long.st)
head(long.engage)
long.t1 <- merge(long.st, long.engage, by=c("ID", "ng"))
head(long.t1)
table(long.t1$ID)
long.t2 <- merge(long.t1, long.agree, by=c("ID", "ng"))
head(long.t2)
long.t3 <- merge(long.t2, long.sim, by=c("ID", "ng"))
head(long.t3)
long.t4 <- merge(long.t3, long.lik, by=c("ID", "ng"))
head(long.t4)
long <- merge(long.t4, long.clo.plus, by=c("ID", "ng"))
head(long)
#Load Data
setwd("~/Documents/GitHub/Social-News-Project/Social News Project/Social News")
load("socnews.Rdata")
#Create tie strength variable
d$ng1.st <- NA
d$ng1.st = ifelse(d$ng1.fam == 1 | d$ng1.fri == 1, 1, d$ng1.st)
d$ng1.st = ifelse(d$ng1.cow == 1 | d$ng1.acq == 1 | d$ng1.nei == 1, 0, d$ng1.st)
d$ng2.st <- NA
d$ng2.st = ifelse(d$ng2.fam == 1 | d$ng2.fri == 1, 1, d$ng2.st)
d$ng2.st = ifelse(d$ng2.cow == 1 | d$ng2.acq == 1 | d$ng2.nei == 1, 0, d$ng2.st)
d$ng3.st <- NA
d$ng3.st = ifelse(d$ng3.fam == 1 | d$ng3.fri == 1, 1, d$ng3.st)
d$ng3.st = ifelse(d$ng3.cow == 1 | d$ng3.acq == 1 | d$ng3.nei == 1, 0, d$ng3.st)
#Create ID var
d$ID = row.names(d)
#Filter
d$ng1.st[d$name1 == 0] <- NA
d$ng2.st[d$name2 == 0] <- NA
d$ng3.st[d$name3 == 0] <- NA
d$ng1.engage[d$name1 == 0] <- NA
d$ng2.engage[d$name2 == 0] <- NA
d$ng3.engage[d$name3 == 0] <- NA
d$ng1.agree[d$name1 == 0] <- NA
d$ng2.agree[d$name2 == 0] <- NA
d$ng3.agree[d$name3 == 0] <- NA
d$ng1.sim[d$name1 == 0] <- NA
d$ng2.sim[d$name2 == 0] <- NA
d$ng3.sim[d$name3 == 0] <- NA
d$ng1.lik[d$name1 == 0] <- NA
d$ng2.lik[d$name2 == 0] <- NA
d$ng3.lik[d$name3 == 0] <- NA
d$ng1.clo[d$name1 == 0] <- NA
d$ng2.clo[d$name2 == 0] <- NA
d$ng3.clo[d$name3 == 0] <- NA
#Filter again
x <- subset(d, names > 0)
#Create dataframe for non RM vars
reg.vars <- x %>% select(age, gender, poc, edu, inc, fb.freq,
netsize, newssize, netdiv1, netdiv2, netdiv3,
fbnews, fbnews.dis, fbnews.agr, follow, nfbnews, engage, avoid, unfriend,
fbtalk.freq, fbtalk.size, fbtalk.dis, fbtalk.agr, express,
eff.i, eff.e, int, ideo, pid, know,
soccon, combel, soctrust, commtrust, newstrust, newstrust2,
govtrust, bustrust, scitrust)
#Create dataframes for RM vars
x.st <- x %>% select(ID, ng1.st, ng2.st, ng3.st)
x.st <- x.st %>% rename(ng1 = ng1.st, ng2 = ng2.st, ng3 = ng3.st)
x.engage <- x %>% select(ID, ng1.engage, ng2.engage, ng3.engage)
x.engage <- x.engage %>% rename(ng1 = ng1.engage, ng2 = ng2.engage, ng3 = ng3.engage)
x.agree <- x %>% select(ID, ng1.agree, ng2.agree, ng3.agree)
x.agree <- x.agree %>% rename(ng1 = ng1.agree, ng2 = ng2.agree, ng3 = ng3.agree)
x.sim <- x %>% select(ID, ng1.sim, ng2.sim, ng3.sim)
x.sim <- x.sim %>% rename(ng1 = ng1.sim, ng2 = ng2.sim, ng3 = ng3.sim)
x.lik <- x %>% select(ID, ng1.lik, ng2.lik, ng3.lik)
x.lik <- x.lik %>% rename(ng1 = ng1.lik, ng2 = ng2.lik, ng3 = ng3.lik)
x.clo <- x %>% select(ID, ng1.clo, ng2.clo, ng3.clo)
x.clo <- x.clo %>% rename(ng1 = ng1.clo, ng2 = ng2.clo, ng3 = ng3.clo)
#Cbind reg vars onto last dataframe
x.clo.plus <- cbind(x.clo, reg.vars)
#Clean up
rm(x, d)
#Put data into long form
long.st <- gather(x.st, ng, st, ng1:ng3, factor_key = TRUE)
long.engage <- gather(x.engage, ng, engage, ng1:ng3, factor_key = TRUE)
long.agree <- gather(x.agree, ng, agree, ng1:ng3, factor_key=TRUE)
long.sim <- gather(x.sim, ng, sim, ng1:ng3, factor_key=TRUE)
long.lik <- gather(x.lik, ng, lik, ng1:ng3, factor_key=TRUE)
long.clo.plus <- gather(x.clo.plus, ng, clo, ng1:ng3, factor_key=TRUE)
#Clean up
rm(reg.vars, x.agree, x.clo, x.clo.plus, x.engage, x.lik, x.sim, x.st)
#Merge
long.t1 <- merge(long.st, long.engage, by=c("ID", "ng"))
long.t2 <- merge(long.t1, long.agree, by=c("ID", "ng"))
long.t3 <- merge(long.t2, long.sim, by=c("ID", "ng"))
long.t4 <- merge(long.t3, long.lik, by=c("ID", "ng"))
long <- merge(long.t4, long.clo.plus, by=c("ID", "ng"))
#Clean up environment
rm(long.agree, long.clo, long.clo.plus, long.engage, long.sim, long.lik, long.st,
long.t1, long.t2, long.t3, long.t4)
with(long, (cor(cbind(st, engage, agree, sim, lik, clo),
use="complete.obs")))
with(long, (cor(cbind(st, engage.x, agree, sim, lik, clo),
use="complete.obs")))
save(long, file="long.Rdata")
rm(long)
#Load Data
setwd("~/Documents/GitHub/Social-News-Project/Social News Project/Social News")
load("long.Rdata")
load("socnews.Rdata")
setwd("~/Documents/GitHub/Social-News-Project/Social News Project/Social News")
load("socnews.Rdata")
#Create tie strength variable
d$ng1.st <- NA
d$ng1.st = ifelse(d$ng1.fam == 1 | d$ng1.fri == 1, 1, d$ng1.st)
d$ng1.st = ifelse(d$ng1.cow == 1 | d$ng1.acq == 1 | d$ng1.nei == 1, 0, d$ng1.st)
d$ng2.st <- NA
d$ng2.st = ifelse(d$ng2.fam == 1 | d$ng2.fri == 1, 1, d$ng2.st)
d$ng2.st = ifelse(d$ng2.cow == 1 | d$ng2.acq == 1 | d$ng2.nei == 1, 0, d$ng2.st)
d$ng3.st <- NA
d$ng3.st = ifelse(d$ng3.fam == 1 | d$ng3.fri == 1, 1, d$ng3.st)
d$ng3.st = ifelse(d$ng3.cow == 1 | d$ng3.acq == 1 | d$ng3.nei == 1, 0, d$ng3.st)
#Create ID var
d$ID = row.names(d)
#Filter
d$ng1.st[d$name1 == 0] <- NA
d$ng2.st[d$name2 == 0] <- NA
d$ng3.st[d$name3 == 0] <- NA
d$ng1.engage[d$name1 == 0] <- NA
d$ng2.engage[d$name2 == 0] <- NA
d$ng3.engage[d$name3 == 0] <- NA
d$ng1.agree[d$name1 == 0] <- NA
d$ng2.agree[d$name2 == 0] <- NA
d$ng3.agree[d$name3 == 0] <- NA
d$ng1.sim[d$name1 == 0] <- NA
d$ng2.sim[d$name2 == 0] <- NA
d$ng3.sim[d$name3 == 0] <- NA
d$ng1.lik[d$name1 == 0] <- NA
d$ng2.lik[d$name2 == 0] <- NA
d$ng3.lik[d$name3 == 0] <- NA
d$ng1.clo[d$name1 == 0] <- NA
d$ng2.clo[d$name2 == 0] <- NA
d$ng3.clo[d$name3 == 0] <- NA
d$names
x <- subset(d, names > 0)
reg.vars <- x %>% select(age, gender, poc, edu, inc, fb.freq,
netsize, newssize, netdiv1, netdiv2, netdiv3,
fbnews, fbnews.dis, fbnews.agr, follow, nfbnews, engage, avoid, unfriend,
fbtalk.freq, fbtalk.size, fbtalk.dis, fbtalk.agr, express,
eff.i, eff.e, int, ideo, pid, know,
soccon, combel, soctrust, commtrust, newstrust, newstrust2,
govtrust, bustrust, scitrust)
library(dplyr)
library(tidyverse)
detach("package:tidyverse", unload = TRUE)
reg.vars <- x %>% select(age, gender, poc, edu, inc, fb.freq,
netsize, newssize, netdiv1, netdiv2, netdiv3,
fbnews, fbnews.dis, fbnews.agr, follow, nfbnews, engage, avoid, unfriend,
fbtalk.freq, fbtalk.size, fbtalk.dis, fbtalk.agr, express,
eff.i, eff.e, int, ideo, pid, know,
soccon, combel, soctrust, commtrust, newstrust, newstrust2,
govtrust, bustrust, scitrust)
head(x)
x.st <- x %>% select(ID, ng1.st, ng2.st, ng3.st)
x.st <- x.st %>% rename(ng1 = ng1.st, ng2 = ng2.st, ng3 = ng3.st)
head(x.st)
x.engage <- x %>% select(ID, ng1.engage, ng2.engage, ng3.engage)
x.engage <- x.engage %>% rename(ng1 = ng1.engage, ng2 = ng2.engage, ng3 = ng3.engage)
x.agree <- x %>% select(ID, ng1.agree, ng2.agree, ng3.agree)
x.agree <- x.agree %>% rename(ng1 = ng1.agree, ng2 = ng2.agree, ng3 = ng3.agree)
x.sim <- x %>% select(ID, ng1.sim, ng2.sim, ng3.sim)
x.sim <- x.sim %>% rename(ng1 = ng1.sim, ng2 = ng2.sim, ng3 = ng3.sim)
x.lik <- x %>% select(ID, ng1.lik, ng2.lik, ng3.lik)
x.lik <- x.lik %>% rename(ng1 = ng1.lik, ng2 = ng2.lik, ng3 = ng3.lik)
x.clo <- x %>% select(ID, ng1.clo, ng2.clo, ng3.clo)
x.clo <- x.clo %>% rename(ng1 = ng1.clo, ng2 = ng2.clo, ng3 = ng3.clo)
x.clo.plus <- cbind(x.clo, reg.vars)
head(x.clo)
head(x.clo.plus)
rm(x, d)
head(x.st)
long.st <- gather(x.st, ng, st, ng1:ng3, factor_key = TRUE)
head(long.st)
long.engage <- gather(x.engage, ng, engage, ng1:ng3, factor_key = TRUE)
long.agree <- gather(x.agree, ng, agree, ng1:ng3, factor_key=TRUE)
long.sim <- gather(x.sim, ng, sim, ng1:ng3, factor_key=TRUE)
long.lik <- gather(x.lik, ng, lik, ng1:ng3, factor_key=TRUE)
long.clo.plus <- gather(x.clo.plus, ng, clo, ng1:ng3, factor_key=TRUE)
rm(reg.vars, x.agree, x.clo, x.clo.plus, x.engage, x.lik, x.sim, x.st)
long.t1 <- merge(long.st, long.engage, by=c("ID", "ng"))
long.t2 <- merge(long.t1, long.agree, by=c("ID", "ng"))
long.t3 <- merge(long.t2, long.sim, by=c("ID", "ng"))
long.t4 <- merge(long.t3, long.lik, by=c("ID", "ng"))
long <- merge(long.t4, long.clo.plus, by=c("ID", "ng"))
rm(long.agree, long.clo.plus, long.engage, long.sim, long.lik, long.st,
long.t1, long.t2, long.t3, long.t4)
head(long)
with(long, (cor(cbind(st, engage.x, agree, sim, lik, clo),
use="complete.obs")))
#Load Data
setwd("~/Documents/GitHub/Social-News-Project/Social News Project/Social News")
load("socnews.Rdata")
load("long.Rdata")
#MLM
library(lme4)
library(lmerTest)
library(sjstats)
m1 = lmer(sim ~ agree + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
m2 = lmer(lik ~ agree + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
m3 = lmer(clo ~ agree + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
icc(m1)
icc(m2)
icc(m3)
summary(m1, cor=FALSE)
summary(m2, cor=FALSE)
summary(m3, cor=FALSE)
names(d)
table(d$fb.acct)
with(subset(d, fb.acct==1),
cor(cbind(d$fb.freq, d$soccon, d$combel),
use="complete.obs", method="pearson"))
names(d)
with(subset(d, fb.acct==1),
cor(cbind(d$fbnews, d$soccon, d$combel),
use="complete.obs", method="pearson"))
m4 = lmer(engage.x ~ agree + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
names(long)
m4 = lmer(engage.x ~ agree*int + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
m4 = lmer(engage.x ~ agree*I(abs(pid)) + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
m4 = lmer(engage.x ~ agree*I(abs(ideo)) + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
m4 = lmer(engage.x ~ agree + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
m4 = lmer(soccon ~ agree*engage.x + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
m4 = lmer(soccon ~ engage.x + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
m4 = lmer(soccon ~ agree + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
m4 = lmer(combel ~ agree + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
m4 = lmer(combel ~ engage.x + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
m4 = lmer(soccon ~ engage.x + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
m4 = lmer(soccon ~ engage.x + (1 + engage.x | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
m4 = lmer(combel ~ engage.x + (1 + engage.x | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
mean(long$agree)
mean(long$agree, na.rm=TRUE)
summary(long$agree)
m4 = lmer(soccon ~ agree + engage.x + (1 + agree + engage.x | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
m4 = lmer(soccon ~ agree + engage.x + (1 | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
summary(long$engage.x)
hist(long$engage.x)
hist(long$agree)
summary(m4)
names(long)
m4 = lmer(soctrust ~ agree + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
names(xd)
names(d)
names(long)
m4 = lmer(commtrust ~ agree + (1 + agree | ID), data=long,
control=lmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
summary(m4)
with(subset(d, fb.acct==1),
cor(cbind(d$fb.freq, d$soccon, d$combel,
d$soctrust, d$commtrust, d$newstrust, d$newstrust2,
d$bustrust, d$govtrust, d$scitrust),
use="complete.obs", method="pearson"))
